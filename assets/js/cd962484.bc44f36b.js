"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[17792],{95524:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>x,frontMatter:()=>s,metadata:()=>l,toc:()=>a});var r=i(85893),t=i(11151);const s={},o="Experiment Executor Service",l={id:"docs/dev-manuals/other-repositories/experiment-executor",title:"Experiment Executor Service",description:"The Experiment Executor is the core component of the MiSArch Experiment Tool.",source:"@site/docs/docs/dev-manuals/other-repositories/experiment-executor.mdx",sourceDirName:"docs/dev-manuals/other-repositories",slug:"/docs/dev-manuals/other-repositories/experiment-executor",permalink:"/docs/docs/dev-manuals/other-repositories/experiment-executor",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Experiment Executor Frontend Service",permalink:"/docs/docs/dev-manuals/other-repositories/experiment-executor-frontend"},next:{title:"Gatling Executor Service",permalink:"/docs/docs/dev-manuals/other-repositories/gatling-executor"}},c={},a=[{value:"API",id:"api",level:2},{value:"Experiment Management",id:"experiment-management",level:4},{value:"Configuration",id:"configuration",level:4},{value:"Execution",id:"execution",level:4},{value:"Synchronization &amp; Metrics",id:"synchronization--metrics",level:4},{value:"Technology Stack",id:"technology-stack",level:2},{value:"Repository Structure",id:"repository-structure",level:2},{value:"Experiment Execution Process",id:"experiment-execution-process",level:2},{value:"Starting an Experiment",id:"starting-an-experiment",level:3},{value:"Synchronization &amp; Registration",id:"synchronization--registration",level:3},{value:"Special Handling",id:"special-handling",level:3},{value:"Execution Phase",id:"execution-phase",level:3},{value:"Completion &amp; Reporting",id:"completion--reporting",level:3},{value:"Stopping an Experiment",id:"stopping-an-experiment",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"experiment-executor-service",children:"Experiment Executor Service"}),"\n",(0,r.jsx)(n.p,{children:"The Experiment Executor is the core component of the MiSArch Experiment Tool.\nIt is responsible for (1) the creation and storage of experiments, (2) the execution of stored experiments by calling the executor components at\nthe correctly scheduled time, (3) the collection and transformation of the Gatling metrics, and (4) the creation of the final Grafana dashboard and the report."}),"\n",(0,r.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,r.jsx)(n.p,{children:"The Experiment Executor exposes the following REST API endpoints to manage and execute experiments."}),"\n",(0,r.jsx)(n.h4,{id:"experiment-management",children:"Experiment Management"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /experiment/generate"})," - Generate a new experiment with a new UUID"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /experiment/list"})," - List all experiments with their versions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /experiment/{testUUID}/versions"})," - List all versions of a specific experiment"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /experiment/{testUUID}/{testVersion}/newVersion"})," - Create a new version of an existing experiment"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DELETE /experiment/{testUUID}"})," - Delete an experiment with all its versions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DELETE /experiment/{testUUID}/{testVersion}"})," - Delete a specific version of an experiment"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /experiment/{testUUID}/{testVersion}/chaosToolkitConfig"})," - Get the Chaos Toolkit configuration of a specific experiment version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PUT /experiment/{testUUID}/{testVersion}/chaosToolkitConfig"})," - Update the Chaos Toolkit configuration of a specific experiment version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /experiment/{testUUID}/{testVersion}/misarchExperimentConfig"})," - Get the MiSArch Experiment Config of a specific experiment version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PUT /experiment/{testUUID}/{testVersion}/misarchExperimentConfig"})," - Update the MiSArch Experiment Config of a specific experiment version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /experiment/{testUUID}/{testVersion}/gatlingConfig"})," - Get the Gatling configuration of a specific experiment version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PUT /experiment/{testUUID}/{testVersion}/gatlingConfig"})," - Update the Gatling configuration of a specific experiment version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /experiment/{testUUID}/{testVersion}/config"})," - Get the global experiment configuration of a specific experiment version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PUT /experiment/{testUUID}/{testVersion}/config"})," - Update the global experiment configuration of a specific experiment version"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"execution",children:"Execution"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"POST /experiment/start"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /experiment/{testUUID}/{testVersion}/start"})," - Start the execution of a specific experiment version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /experiment/{testUUID}/{testVersion}/stop"})," - Stop the execution of a specific experiment version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /experiment/{testUUID}/{testVersion}/events"})," - Register for server-sent events to get experiment execution updates"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"synchronization--metrics",children:"Synchronization & Metrics"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /trigger/{testUUID}/{testVersion}"})," - Register a component (Gatling Executor, Chaos Toolkit Executor, MiSArch Experiment Config) as ready"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /trigger/{testUUID}/{testVersion}"})," - Poll if the experiment can start"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST /experiment/{testUUID}/{testVersion}/gatling/metrics/steadyState"})," - Forward steady-state metrics from Gatling Executor"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"technology-stack",children:"Technology Stack"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Language"}),": Kotlin"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Framework"}),": Spring Boot"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Asynchronous Processing"}),": Spring WebFlux + Kotlin Coroutines"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"repository-structure",children:"Repository Structure"}),"\n",(0,r.jsx)(n.p,{children:"The repository is structured as follows:"}),"\n",(0,r.jsx)("div",{className:"repository-structure",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"/src/"}),": Source code of the service","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"config"}),": Package that includes several configuration classes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"controller/"}),": Package that includes all REST controllers","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"experiment/"}),": Different controllers for the experiment lifecycle"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"service/"}),": Package for all service classes containing the actual business logic"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"model/"}),": Package that includes the main data model","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ExperimentCofig"}),": The global experiment configuration schema"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"plugin"}),": Package that includes all plugin classes for the different technologies","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"export"}),": Plugins for Grafana export, LLM export and report generation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"failure"}),": Plugins for failure execution with Chaos Toolkit Executor and MiSArch Experiment Config"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"workload"}),": Plugin for Gatling Executor workload execution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"metrics"}),": Plugins for metrics transformation and storage from Prometheus and Gatling"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,r.jsx)(n.h2,{id:"experiment-execution-process",children:"Experiment Execution Process"}),"\n",(0,r.jsx)(n.p,{children:"The following steps describe the workflow that is executed when an experiment is started."}),"\n",(0,r.jsx)(n.h3,{id:"starting-an-experiment",children:"Starting an Experiment"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Initiation:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Start via API call or UI button."}),"\n",(0,r.jsx)(n.li,{children:"Loads experiment configuration from persistent storage."}),"\n",(0,r.jsx)(n.li,{children:"If no execution for the same version is running, a temporary state is created in memory."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Component Preparation:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Sends HTTP requests:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Failure configuration \u2192 Chaos Toolkit Executor"}),"\n",(0,r.jsx)(n.li,{children:"Workload configuration \u2192 Gatling Executor"}),"\n",(0,r.jsx)(n.li,{children:"Reset failures \u2192 MiSArch Experiment Config"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Waits for all components to be ready."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"synchronization--registration",children:"Synchronization & Registration"}),"\n",(0,r.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant EE as Experiment Executor\n    participant MEC as MiSArch Experiment Config\n    participant CTE as Chaos Toolkit Executor\n    participant GE as Gatling Executor\n    participant GR as Grafana\n\n    EE->>MEC: Reset All Configurations\n    EE->>EE: Register MiSArch Experiment Config as Ready\n    EE->>CTE: Send Failure Injection Configuration\n    CTE->>CTE: Load Failure Configuration and Prepare Execution\n    EE->>GE: Send Load Test Configuration\n    GE->>GE: Load Load Test Configuration and Prepare Execution\n\n    loop Poll Experiment Trigger\n        EE->>EE: Check Trigger Condition\n    end\n\n    CTE->>EE: Register Chaos Toolkit as Ready\n    loop Poll Experiment Trigger\n        CTE->>EE: Check Trigger Condition\n    end\n\n\n    GE->>EE: Register Gatling as Ready\n    loop Poll Experiment Trigger\n        GE->>EE: Check Trigger Condition\n    end\n\n    EE->>CTE: Start Chaos Toolkit Execution\n    EE->>GE: Start Load Execution\n    EE->>EE: Start MiSArch Experiment Execution\n\n    loop Configure Failure\n        EE->>MEC: Apply Failure Configuration\n    end\n\n    loop Configure Failure\n        CTE->>CTE: Apply Failure Configuration\n    end\n\n\n    loop Execute Workload\n        GE->>GE: Execute Workload against SuT\n    end\n\n    GE->>EE: Load Test Metrics\n    EE->>EE: Aggregate and Store Results\n    EE->>GR: Forward Result Dashboard"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Endpoints Provided:","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Register component as ready."}),"\n",(0,r.jsx)(n.li,{children:"Poll if experiment can start."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Readiness:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All three components (Gatling Executor, Chaos Toolkit Executor, MiSArch Experiment Configuration) must register."}),"\n",(0,r.jsx)(n.li,{children:"Polling every 100 ms; experiment starts when all are ready (max 300 ms diff)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Scheduling:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Failure scheduling is handled by Experiment Executor."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"special-handling",children:"Special Handling"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Warm-up / Steady-State Hypothesis:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Gatling Executor runs these before registering as ready."}),"\n",(0,r.jsx)(n.li,{children:"Metrics are forwarded to Experiment Executor for threshold calculation and goal storage."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"execution-phase",children:"Execution Phase"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Start:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Timestamp is marked."}),"\n",(0,r.jsx)(n.li,{children:"Failure injection is managed by Experiment Executor."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Component Responsibilities:"}),"\n",(0,r.jsx)(n.li,{children:"Chaos Toolkit Executor and Gatling Executor handle their respective tasks."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"completion--reporting",children:"Completion & Reporting"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Metrics Collection:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Gatling Executor sends HTML and JS metrics files."}),"\n",(0,r.jsx)(n.li,{children:"Experiment Executor marks completion, clears state, and transforms metrics for InfluxDB."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Report Generation:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Stores execution timestamps, goals, and threshold violations."}),"\n",(0,r.jsx)(n.li,{children:"Optionally stores raw metrics and queries Prometheus for additional data."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Dashboard Creation:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Grafana dashboard is parameterized and forwarded."}),"\n",(0,r.jsx)(n.li,{children:"Frontend is notified via server-side events with dashboard URL."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"stopping-an-experiment",children:"Stopping an Experiment"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Stop Endpoint:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Terminates MiSArch Experiment Configuration thread."}),"\n",(0,r.jsx)(n.li,{children:"Calls stop endpoints for Gatling Executor and Chaos Toolkit Executor."}),"\n",(0,r.jsx)(n.li,{children:"Clears experiment state."}),"\n"]}),"\n"]}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>l,a:()=>o});var r=i(67294);const t={},s=r.createContext(t);function o(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);